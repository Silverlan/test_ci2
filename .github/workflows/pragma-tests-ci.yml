name: Run Pragma Workflow

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  run-pragma:
    runs-on: windows-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Run Pragma Custom Action
        id: pragma
        uses: Silverlan/test_ci2/github_actions/test@main  # This points to the root directory of your repository where action.yml is located
        with:
          state: "server"
          lua-code: |
            local test = \"Hello\"
            print(\"Test Message: \", test)
            print(engine.load_library(\"mount_external/pr_mount_external\"))
            print(\"Import: \",asset.import(\"headcrabclassic\", asset.TYPE_MODEL))
            --game.load_model(\"headcrabclassic\")

      - name: Output Result
        shell: bash
        if: always()
        run: |
          echo "Exit-code: ${{ steps.pragma.outputs.exit-code }}"
          echo "Error: ${{ steps.pragma.outputs.error }}"
          echo "Lua-error: ${{ steps.pragma.outputs.lua-error }}"
